---
title: "캐시에 대한 생각"
excerpt: "캐시에 ttl에 대한 생각"

categories:
  - diary
tags:
  - tag1

permalink: /diary/3rd/

toc: true
toc_sticky: true

date: 2024-11-27
last_modified_at: 2024-11-27
---

##  cache ttl에 대한 생각 
서버에 사용자의 요청을 받아서 메세지를 써주는 기능이 있다.  
이 요청은 이미지 url을 받으면 이미지도 같이 보여주는데, 보안 요구사항이 있어 이미지인지 아닌지 체크를 하는 로직이 들어갔다.  
체크 로직은 타 서버에서 진행하고 특정 url에 대한 이미지 판단 결과를 1일 캐시로 저장한다.  
최근에 이미지 체크를 진행하는 서버가 이전하면서 그 타이밍에 문제가 있었는지,  
알림에 사용되는 이미지 중 하나의 판단결과가 이미지 아님으로 저장되었다.  
작업중이었던 터라 바로 레디스에 가서 해당 캐시를 지우고 다시 세팅되게 해서 해결했지만 1일 캐시는 너무 긴 것 같다.  
&rarr; 이미지인지 아닌지 판단한 결과가 바뀔 일이 없을 것 같아 1일로 세팅한 것 같긴 한데 다른서버에서 응답으로 받아오는 결과니까 짧게 설정해야 하지 않을까?   
&rarr; 5분으로 설정해도 큰 부담은 없을 것 같다. 모종의 이유로 잘못 저장되는 경우에도 5분후면 해소될것이고..  
&rarr; 또 다른 ttl이 길게 잡힌 캐시는 없는지 확인해봐야할듯 

알람에서 사용하는 이미지같이 자주 사용하는 url 이면서 무조건 이미지인지 알고있는 경우를 white list? 로 빼야하지 않았을까? 라는 생각도 든다.



